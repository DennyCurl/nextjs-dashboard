# Інструкція з налаштування меню користувача

## Опис
Додано меню в sidebar, яке показує інформацію про користувача та його призначення з таблиці `users.assignments`.

## Зміни в коді

1. **Додано типи** в `app/lib/definitions.ts`:
   - `Organization`
   - `Department`
   - `Localization`
   - `UserAssignment`

2. **Створено клієнтський компонент** `app/ui/dashboard/user-info-client.tsx`:
   - Відображає кнопку з email користувача
   - При кліку відкривається dropdown меню з детальною інформацією
   - Показує всі призначення користувача (організація, відділ, локалізація, роль, рівень)

3. **Оновлено серверний компонент** `app/ui/dashboard/user-info.tsx`:
   - Завантажує дані користувача та його призначення з Supabase
   - Передає дані в клієнтський компонент

## Налаштування бази даних

### 1. Створіть таблиці (якщо ще не створені)

Виконайте SQL з файлу `create-user-assignments-tables.sql`:

```bash
# У вашому Supabase SQL Editor виконайте:
```

Цей файл створить:
- `users.organizations` - таблиця організацій
- `users.departments` - таблиця відділів
- `users.localizations` - таблиця локалізацій
- Додасть приклади даних

### 2. Переконайтеся, що таблиця assignments існує

Таблиця `users.assignments` повинна вже існувати з такою структурою:

```sql
CREATE TABLE users.assignments (
  user_id uuid NOT NULL,
  organization_id bigint NOT NULL,
  department_id bigint NULL,
  localization_id bigint NULL,
  role_id bigint NOT NULL,
  level bigint NULL,
  id bigint GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  CONSTRAINT assignments_pkey PRIMARY KEY (id),
  CONSTRAINT local_assignments_role_id_fkey FOREIGN KEY (role_id) 
    REFERENCES users.roles (id) ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT localization_assignments_department_id_fkey FOREIGN KEY (department_id) 
    REFERENCES users.departments (id) ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT localization_assignments_localization_id_fkey FOREIGN KEY (localization_id) 
    REFERENCES users.localizations (id) ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT localization_assignments_organization_id_fkey FOREIGN KEY (organization_id) 
    REFERENCES users.organizations (id) ON UPDATE CASCADE ON DELETE CASCADE,
  CONSTRAINT localization_assignments_user_id_fkey FOREIGN KEY (user_id) 
    REFERENCES users.users (user_id) ON UPDATE CASCADE ON DELETE CASCADE
);
```

### 3. Додайте тестові призначення

```sql
-- Додайте призначення для вашого користувача
INSERT INTO users.assignments (
  user_id, 
  organization_id, 
  department_id, 
  localization_id, 
  role_id, 
  level
) VALUES (
  'ваш-user-id-uuid',  -- Замініть на реальний UUID користувача
  1,                    -- ID організації
  1,                    -- ID відділу (можна NULL)
  1,                    -- ID локалізації (можна NULL)
  1,                    -- ID ролі
  1                     -- Рівень (можна NULL)
);
```

## Використання

Після входу в систему:
1. В лівому sidebar внизу з'явиться кнопка "Увійшов як: [email]"
2. Клік по кнопці відкриє dropdown меню
3. В меню відображається:
   - Ім'я користувача (якщо є)
   - Email
   - Список всіх призначень з деталями:
     - Організація
     - Відділ (якщо вказано)
     - Локалізація (якщо вказано)
     - Роль
     - Рівень (якщо вказано)

## Примітки

- Меню відображається тільки на десктопі (md breakpoint і більше)
- Якщо у користувача немає призначень, показується повідомлення "Немає призначень"
- Меню автоматично закривається при повторному кліку на кнопку
- Максимальна висота меню - 96 (max-h-96) з прокруткою для багатьох призначень
